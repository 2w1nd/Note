[87. 扰乱字符串](https://leetcode-cn.com/problems/scramble-string/):star::star::star::star::star:

```cpp
class Solution {
public:

    vector<vector<vector<int>>> cache;
    int Y = 1, N = -1;
    string s1, s2;
    bool isScramble(string _s1, string _s2) {
        s1 = _s1, s2 = _s2;
        if (s1 == s2) return true;
        if (s1.size() != s2.size()) return false;
        int n = s1.size();
        // cache表示s1从i开始，s2从j开始 len 位，是否形成扰动字符串
        cache.resize(n, vector<vector<int>>(n, vector<int>(n + 1, 0)));
        return dfs(0, 0, n);
    }

    bool dfs(int i, int j, int len) {
        if (cache[i][j][len] != 0) return cache[i][j][len] == Y;
        string a = s1.substr(i, len), b = s2.substr(j, len);
        if (a == b){
            cache[i][j][len] = Y;
            return true;
        } 
        if (!check(a, b)) {
            cache[i][j][len] = N;
            return false;
        }

        for (int k = 1; k < len; k ++) {
            if (dfs(i, j, k) && dfs(i + k, j + k, len - k)) {
                cache[i][j][len] = Y;
                return true;
            }
            if (dfs(i, len - k + j, k) && dfs(i + k, j, len - k)) {
                cache[i][j][len] = Y;
                return true;
            }
        }
        cache[i][j][len] = N;
        return false;
    }

    bool check(string a, string b) {
        if (a.size() != b.size()) return false;

        vector<int> cnt1(26, 0), cnt2(26, 0);
        for (auto c: s1) {
            cnt1[c - 'a'] ++;
        }
        for (auto c: s2) {
            cnt2[c - 'a'] ++;
        }
        return cnt1 == cnt2;
    }
};
```

